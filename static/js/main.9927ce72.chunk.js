(this["webpackJsonpreact_people-table"]=this["webpackJsonpreact_people-table"]||[]).push([[0],{28:function(e,a,t){e.exports=t(49)},49:function(e,a,t){"use strict";t.r(a);var r=t(0),n=t.n(r),l=t(25),c=t.n(l),s=t(5),o=(t(33),t(1)),u=function(){return n.a.createElement("header",null,n.a.createElement("nav",{className:"navbar"},n.a.createElement("ul",{className:"navbar-menu"},n.a.createElement("li",null,n.a.createElement(s.c,{to:"/",exact:!0,className:"navbar-item is-tab",activeClassName:"is-active"},"Home")),n.a.createElement("li",null,n.a.createElement(s.c,{to:"/people",className:"navbar-item is-tab",activeClassName:"is-active"},"People")))))},m=function(){return n.a.createElement("h1",{className:"title"},"Home Page")},i=t(14),d=t(10),f=t(27),p=t.n(f),E=(t(48),t(9)),v=t.n(E),h=function(e){var a=e.slug,t=e.name,r=e.sex,l=Object(o.i)().url,c=Object(o.h)().search;return n.a.createElement(s.b,{to:{pathname:"".concat(l,"/").concat(a),search:c},className:v()({"has-text-info":"m"===r,"has-text-danger":"f"===r})},t)};h.defaultProps={name:"",sex:""};t(4);var b=function(e){var a=e.person,t=Object(o.i)("/people/:personId?").params.personId;return null!==a&&n.a.createElement("tr",{className:v()("Person",{"is-selected":t===a.slug})},n.a.createElement("td",null,n.a.createElement(h,a)),n.a.createElement("td",null,a.sex),n.a.createElement("td",null,a.born),n.a.createElement("td",null,a.died),n.a.createElement("td",null,a.mother?n.a.createElement(h,a.mother):a.motherName),n.a.createElement("td",null,a.father?n.a.createElement(h,a.father):a.fatherName))};b.defaultProps={person:null};var O=[{name:"Name",sort:!0},{name:"Sex",sort:!0},{name:"Born",sort:!0},{name:"Died",sort:!0},{name:"Mother",sort:!1},{name:"Father",sort:!1}],N=function(e){var a=e.people,t=e.sortedBy,r=e.sortOrder,l=e.onColumnClick;return n.a.createElement("table",{className:"table is-striped is-hoverable",style:{borderCollapse:"collapse"}},n.a.createElement("thead",null,n.a.createElement("tr",null,O.map((function(e){var a=e.name.toLowerCase();return n.a.createElement("th",{key:e.name},n.a.createElement("button",{type:"button",className:v()("button","is-white",{"is-primary is-light":t===a}),onClick:function(){return l(a)},disabled:!e.sort},n.a.createElement("span",null,e.name),e.sort&&n.a.createElement("span",{className:"icon is-small"},n.a.createElement("i",{className:v()("fas",{"fa-sort-up":t===a&&"asc"===r,"fa-sort-down":t===a&&"desc"===r,"fa-sort":t!==a||!r})}))))})))),n.a.createElement("tbody",null,a.map((function(e){return n.a.createElement(b,{key:e.slug,person:e})}))))};function g(e,a){return"".concat(e.split(" ").join("-").toLowerCase(),"-").concat(a)}function y(e,a){return!a.value||!a.meta.isValid||!e||0===e.length}N.defaultProps={people:[],sortedBy:"",sortOrder:""};var j=t(13),C=t(3);function w(e,a,t){switch(e){case"name":return{isValid:-1===a.search(/\d/g),errorMessage:"Only letters and spaces are allowed in the name"};case"born":var r=x(a);return r.isValid?B(a,t.died.value):r;case"died":var n=x(a);return n.isValid?B(t.born.value,a):n;default:return{isValid:!0,errorMessage:""}}}function x(e){var a=(new Date).getFullYear();return{isValid:e>=1400&&e<=a,errorMessage:"Year should be >= 1400 and <= ".concat(a)}}function B(e,a){var t=a-e;return{isValid:""===a||t>=0&&t<150,errorMessage:"Difference between born and died should be >= 0 and < 150"}}var R=function(){return{type:"RESET"}},V=function(e,a){return{type:"SET_FIELD",field:e,value:a}},M=["name","sex","born","died","mother","father"].reduce((function(e,a){return Object(C.a)(Object(C.a)({},e),{},Object(j.a)({},a,{value:"",meta:{isValid:!0,errorMessage:""}}))}),{});function P(e,a){var t=a.type,r=a.field,n=a.value;switch(t){case"SET_FIELD":return Object(C.a)(Object(C.a)({},e),{},Object(j.a)({},r,{value:n,meta:w(r,n,e)}));case"RESET":return Object(C.a)({},M);default:return e}}var S=function(e){var a=e.people,t=e.onAddPerson,l=Object(r.useReducer)(P,M),c=Object(d.a)(l,2),s=c[0],u=c[1],m=s.name,i=s.sex,f=s.born,p=s.died,E=s.mother,h=s.father,b=Object(r.useMemo)((function(){return function(e,a,t){if(!a.value||!a.meta.isValid)return[];var r=function(e,t){return e.sex===t&&e.born<a.value&&e.died>a.value};return[e.filter((function(e){return r(e,"f")})),e.filter((function(e){return r(e,"m")}))]}(a,f)}),[a,f,p]),O=Object(d.a)(b,2),N=O[0],j=O[1],C=Object.values(s).every((function(e){return e.meta.isValid})),w=function(e){u(V(e.target.name,e.target.value))},x=Object(o.g)(),B=Object(o.h)().search;return n.a.createElement("div",{className:"card"},n.a.createElement("div",{className:"section"},n.a.createElement("form",{method:"post",onSubmit:function(e){e.preventDefault(),u(R());var r=a.find((function(e){return e.slug===E.value}))||null,n=a.find((function(e){return e.slug===h.value}))||null;t({name:m.value,slug:"".concat(g(m.value,f.value)),sex:i.value,born:+f.value,died:+p.value,motherName:null===r||void 0===r?void 0:r.name,mother:r,fatherName:null===n||void 0===n?void 0:n.name,father:n}),x.push({pathname:"/people",search:B})}},n.a.createElement("div",{className:"field"},n.a.createElement("div",{className:"control"},n.a.createElement("input",{type:"text",className:v()("input",{"is-danger":!m.meta.isValid}),name:"name",placeholder:"Name",value:m.value,onChange:w,required:!0})),m.meta.isValid||n.a.createElement("p",{className:"help is-danger"},m.meta.errorMessage)),n.a.createElement("div",{className:"field"},n.a.createElement("div",{className:"control"},n.a.createElement("label",{className:"radio"},n.a.createElement("input",{type:"radio",name:"sex",value:"m",checked:"m"===i.value,onChange:w,required:!0}),"Male"),n.a.createElement("label",{className:"radio"},n.a.createElement("input",{type:"radio",name:"sex",value:"f",checked:"f"===i.value,onChange:w,required:!0}),"Female"))),n.a.createElement("div",{className:"field is-horizontal"},n.a.createElement("div",{className:"field-body"},n.a.createElement("div",{className:"field"},n.a.createElement("div",{className:"control"},n.a.createElement("input",{type:"number",className:v()("input",{"is-danger":!f.meta.isValid}),name:"born",placeholder:"Born",value:f.value,onChange:w,required:!0})),f.meta.isValid||n.a.createElement("p",{className:"help is-danger"},f.meta.errorMessage)),n.a.createElement("div",{className:"field"},n.a.createElement("div",{className:"control"},n.a.createElement("input",{type:"number",className:v()("input",{"is-danger":!p.meta.isValid}),name:"died",placeholder:"Died",value:p.value,onChange:w,disabled:""===f.value,required:!0})),p.meta.isValid||n.a.createElement("p",{className:"help is-danger"},p.meta.errorMessage)))),n.a.createElement("div",{className:"field is-horizontal"},n.a.createElement("div",{className:"field-body"},n.a.createElement("div",{className:"field"},n.a.createElement("div",{className:"control"},n.a.createElement("div",{className:"select is-fullwidth"},n.a.createElement("select",{name:"mother",value:E.value,onChange:w,disabled:y(N,f)},n.a.createElement("option",null,"Choose a mother"),N&&N.map((function(e){return n.a.createElement("option",{key:e.slug,value:e.slug},e.name)})))))),n.a.createElement("div",{className:"field"},n.a.createElement("div",{className:"control"},n.a.createElement("div",{className:"select is-fullwidth"},n.a.createElement("select",{name:"father",value:h.value,onChange:w,disabled:y(j,f)},n.a.createElement("option",null,"Choose a father"),j&&j.map((function(e){return n.a.createElement("option",{key:e.slug,value:e.slug},e.name)})))))))),n.a.createElement("div",{className:"control"},n.a.createElement("button",{type:"submit",className:"button is-primary",disabled:!C},"Submit")))))};S.defaultProps={people:[]};function k(){var e=Object(r.useState)([]),a=Object(d.a)(e,2),t=a[0],n=a[1];return Object(r.useEffect)((function(){fetch("https://mate-academy.github.io/react_people-table/api/people.json").then((function(e){return e.json()})).then((function(e){n(e.map((function(a){return Object(C.a)(Object(C.a)({},a),{},{mother:e.find((function(e){return e.name===a.motherName}))||null,father:e.find((function(e){return e.name===a.fatherName}))||null})})))}))}),[]),[t,n]}var q=function(e){return{type:"FILTER",query:e}},T=function(e){return{type:"SORT_BY",sortBy:e}},D=function(e){return{type:"SORT_ORDER",sortOrder:e}};function _(e,a){switch(a.type){case"FILTER":return Object(C.a)(Object(C.a)({},e),{},{query:a.query});case"SORT_BY":return Object(C.a)(Object(C.a)({},e),{},{sortBy:a.sortBy,sortOrder:"asc"});case"SORT_ORDER":return Object(C.a)(Object(C.a)({},e),{},{sortOrder:a.sortOrder});default:return e}}var F=function(){var e=k(),a=Object(d.a)(e,2),t=a[0],l=a[1],c=function(){var e=Object(o.g)(),a=Object(o.h)(),t=new URLSearchParams(a.search);return[t,function(a,r){r?t.set(a,r):t.delete(a),e.push({search:t.toString()})}]}(),u=Object(d.a)(c,2),m=u[0],f=u[1],E=m.get("query")||"",v=Object(r.useReducer)(_,{query:E,sortBy:m.get("sortBy")||"",sortOrder:m.get("sortOrder")||""}),h=Object(d.a)(v,2),b=h[0],O=h[1],g=Object(r.useCallback)(p()((function(e){f("query",e)}),500),[]),y=Object(r.useMemo)((function(){return function(e,a){return e.filter((function(e){return-1!==(e.name+e.motherName+e.fatherName).search(new RegExp(a,"i"))}))}(t,E)}),[t,E]),j=Object(r.useMemo)((function(){return function(e,a){return a?Object(i.a)(e).sort((function(e,t){switch(a){case"name":case"sex":return e[a].localeCompare(t[a]);default:return e[a]-t[a]}})):e}(y,b.sortBy)}),[y,b.sortBy]),C=Object(r.useMemo)((function(){return"desc"===b.sortOrder?Object(i.a)(j).reverse():j}),[j,b.sortOrder]),w=Object(o.i)(),x=w.path,B=w.url,R=Object(o.h)().search;return n.a.createElement(n.a.Fragment,null,n.a.createElement("h1",{className:"title"},"People Page"),n.a.createElement("div",{className:"field"},n.a.createElement("div",{className:"control has-icons-left"},n.a.createElement("input",{type:"text",className:"input",value:b.query,onChange:function(e){var a=e.target.value;O(q(a)),g(a)},placeholder:"Enter person's name"}),n.a.createElement("span",{className:"icon is-left"},n.a.createElement("i",{className:"fas fa-search"})))),n.a.createElement(o.d,null,n.a.createElement(o.b,{path:"".concat(x,"/new")},n.a.createElement(S,{people:t,onAddPerson:function(e){return l([].concat(Object(i.a)(t),[e]))}})),n.a.createElement(o.b,null,n.a.createElement("div",{className:"field"},n.a.createElement(s.b,{className:"button is-primary",to:{pathname:"".concat(B,"/new"),search:R}},"Add a Person")))),n.a.createElement(N,{people:C,sortedBy:b.sortBy,sortOrder:b.sortOrder,onColumnClick:function(e){if(b.sortBy===e){var a="asc"===b.sortOrder?"desc":"asc";O(D(a)),f("sortOrder",a)}else O(T(e)),f("sortBy",e),f("sortOrder","asc")}}))},I=function(){return n.a.createElement("h1",{className:"title"},"Page not found")},L=function(){return n.a.createElement("div",{className:"container"},n.a.createElement(u,null),n.a.createElement("div",{className:"section"},n.a.createElement(o.d,null,n.a.createElement(o.b,{path:"/",exact:!0},n.a.createElement(m,null)),n.a.createElement(o.b,{path:"/people"},n.a.createElement(F,null)),n.a.createElement(o.a,{path:"/home",to:"/"}),n.a.createElement(o.b,null,n.a.createElement(I,null)))))};c.a.render(n.a.createElement(s.a,null,n.a.createElement(L,null)),document.getElementById("root"))}},[[28,1,2]]]);
//# sourceMappingURL=main.9927ce72.chunk.js.map